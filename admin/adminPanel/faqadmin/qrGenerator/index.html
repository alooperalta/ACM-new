<!DOCTYPE html>

<head>
	<title>QRCode generator</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript" src="qrcode.js"></script>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<div class="container">
		<h1>QR generator</h1>
		<div class="box">
			<input type="text" placeholder="link for" style="width:80%" /><br />
		</div>
		<div class="box">
			<input id="text" type="text" placeholder="Enter link" style="width:80%" /><br />
		</div>
		<button id="btn" type="submit">Generate qr</button>

		<div id="qrcode" style="width:100px; height:100px; margin-top:15px;"></div>
		<a id='qrdl' id='btn' hidden>download</a>
	</div>
	<script type="text/javascript">
		var qrcode = new QRCode(document.getElementById("qrcode"), {
			width: 100,
			height: 100
		});

		function makeCode() {
			var elText = document.getElementById("text");

			qrcode.makeCode(elText.value);
			setTimeout(() => {
				let qelen = document.querySelector('#qrcode img');
				let dlink = document.querySelector("#qrdl");
				let qr = qelen.getAttribute('src');
				dlink.setAttribute('href', qr);
				dlink.setAttribute('download', 'filename');
				dlink.removeAttribute('hidden');
			}, 500);

		}
		makeCode();

		$("#text").
			on("blur", function () {
				makeCode();
			}).
			on("keydown", function (e) {
				if (e.keyCode == 13) {
					makeCode();
				}
			});
	</script>
</body>